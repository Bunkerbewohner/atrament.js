var Atrament=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){t.exports=n(2)},function(t,e,n){function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var r=n(3);t.exports=function(){function t(e){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"undefined"==typeof window)throw new Error("Looks like we're not running in a browser");if(e instanceof window.Node&&"CANVAS"===e.tagName)this.canvas=e;else{if("string"!=typeof e)throw new Error("can't look for canvas based on '".concat(e,"'"));this.canvas=document.querySelector(e)}if(!this.canvas)throw new Error("canvas not found");this.canvas.width=o.width||this.canvas.width,this.canvas.height=o.height||this.canvas.height,this.canvas.style.cursor="crosshair",this.mouse=new r;var i=function(t){t.cancelable&&t.preventDefault();var e=n.canvas.getBoundingClientRect(),o=t.changedTouches&&t.changedTouches[0]||t,i=o.offsetX,r=o.offsetY;void 0===i&&(i=o.clientX-e.left),void 0===r&&(r=o.clientY-e.top),n.mouse.down?(n.draw(i,r),n._dirty||i===n.mouse.x&&r===n.mouse.y||(n._dirty=!0,n.fireDirty())):(n.mouse.x=i,n.mouse.y=r)},s=function(t){t.cancelable&&t.preventDefault(),i(t),"fill"!==n._mode?(n.mouse.px=n.mouse.x,n.mouse.py=n.mouse.y,n.mouse.down=!0,n.context.beginPath(),n.context.moveTo(n.mouse.px,n.mouse.py)):n.fill()},a=function(t){var e=t.changedTouches&&t.changedTouches[0]||t,o=e.offsetX,i=e.offsetY;n.mouse.down=!1,n.mouse.x===o&&n.mouse.y===i&&n.draw(n.mouse.x,n.mouse.y),n.context.closePath()};this.canvas.addEventListener("mousemove",i),this.canvas.addEventListener("mousedown",s),document.addEventListener("mouseup",a),this.canvas.addEventListener("touchstart",s),this.canvas.addEventListener("touchend",a),this.canvas.addEventListener("touchmove",i),this.destroy=function(){n.clear(),n.canvas.removeEventListener("mousemove",i),n.canvas.removeEventListener("mousedown",s),document.removeEventListener("mouseup",a),n.canvas.removeEventListener("touchstart",s),n.canvas.removeEventListener("touchend",a),n.canvas.removeEventListener("touchmove",i)},this.context=this.canvas.getContext("2d"),this.context.globalCompositeOperation="source-over",this.context.globalAlpha=1,this.context.strokeStyle=o.color||"rgba(0,0,0,1)",this.context.lineCap="round",this.context.lineJoin="round",this.context.translate(.5,.5),this._filling=!1,this._fillStack=[],this.SMOOTHING_INIT=.85,this.WEIGHT_SPREAD=10,this._smoothing=this.SMOOTHING_INIT,this._maxWeight=12,this._thickness=2,this._targetThickness=2,this._weight=2,this._mode="draw",this._adaptive=!0,["weight","smoothing","adaptiveStroke","mode","opacity"].forEach((function(t){return void 0===o[t]?0:n[t]=o[t]}))}var e,n,s;return e=t,s=[{key:"lineDistance",value:function(t,e,n,o){var i=Math.pow(n-t,2),r=Math.pow(o-e,2);return Math.sqrt(i+r)}},{key:"hexToRgb",value:function(t){var e=t.match(/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{key:"matchColor",value:function(t,e,n,o,i){return function(r){var s=t[r],a=t[r+1],c=t[r+2],u=t[r+3];return s===e&&a===n&&c===o&&u===i}}},{key:"colorPixel",value:function(e,n,i,r,s,a){var c=t.matchColor.apply(t,[e].concat(o(s)));return function(t){e[t]=n,e[t+1]=i,e[t+2]=r,e[t+3]=a,c(t+4)||(e[t+4]=.01*e[t+4]+.99*n,e[t+4+1]=.01*e[t+4+1]+.99*i,e[t+4+2]=.01*e[t+4+2]+.99*r,e[t+4+3]=.01*e[t+4+3]+.99*a),c(t-4)||(e[t-4]=.01*e[t-4]+.99*n,e[t-4+1]=.01*e[t-4+1]+.99*i,e[t-4+2]=.01*e[t-4+2]+.99*r,e[t-4+3]=.01*e[t-4+3]+.99*a)}}}],(n=[{key:"draw",value:function(e,n){var o=this.mouse,i=this.context,r=t.lineDistance(e,n,o.px,o.py),s=Math.min(.87,this._smoothing+(r-60)/3e3);o.x=e-(e-o.px)*s,o.y=n-(n-o.py)*s;var a=t.lineDistance(o.x,o.y,o.px,o.py);this._adaptive?(this._targetThickness=(a-1)/49*(this._maxWeight-this._weight)+this._weight,this._thickness>this._targetThickness?this._thickness-=.5:this._thickness<this._targetThickness&&(this._thickness+=.5),i.lineWidth=this._thickness):i.lineWidth=this._weight,i.quadraticCurveTo(o.px,o.py,o.x,o.y),i.stroke(),o.px=o.x,o.py=o.y}},{key:"fireDirty",value:function(){var t=document.createEvent("Event");t.initEvent("dirty",!0,!0),this.canvas.dispatchEvent(t)}},{key:"clear",value:function(){this.dirty&&(this._dirty=!1,this.fireDirty(),"destination-out"===this.context.globalCompositeOperation?(this.mode="draw",this.context.clearRect(-10,-10,this.canvas.width+20,this.canvas.height+20),this.mode="erase"):this.context.clearRect(-10,-10,this.canvas.width+20,this.canvas.height+20))}},{key:"toImage",value:function(){return this.canvas.toDataURL()}},{key:"fill",value:function(){var t=this,e=this.mouse,n=this.context,o=Array.prototype.slice.call(n.getImageData(e.x,e.y,1,1).data,0);this._filling?this._fillStack.push([e.x,e.y,o]):(this.canvas.style.cursor="progress",this._filling=!0,setTimeout((function(){t._floodFill(e.x,e.y,o)}),100))}},{key:"_floodFill",value:function(e,n,i){var r=this,s=this.context,a=Math.floor(e),c=Math.floor(n),u=s.canvas.width,h=s.canvas.height,l=[[a,c]],f=t.hexToRgb(this.color),p=s.getImageData(0,0,s.canvas.width,s.canvas.height),v=Math.min(10*s.globalAlpha*255,255),y=t.colorPixel.apply(t,[p.data].concat(o(f),[i,v])),d=t.matchColor.apply(t,[p.data].concat(o(i)));if(t.matchColor.apply(t,[p.data].concat([].concat(o(f),[255])))(4*(c*s.canvas.width+a)))return this._filling=!1,void setTimeout((function(){r.canvas.style.cursor="crosshair"}),100);for(;l.length;){for(var m=l.pop(),g=m[0],w=m[1],_=4*(w*u+g);w-- >=0&&d(_);)_-=4*u;_+=4*u,++w;for(var b=!1,x=!1;w++<h-1&&d(_);)y(_),g>0&&(d(_-4)?b||(l.push([g-1,w]),b=!0):b&&(b=!1)),g<u-1&&(d(_+4)?x||(l.push([g+1,w]),x=!0):x&&(x=!1)),_+=4*u}s.putImageData(p,0,0),this._fillStack.length?this._floodFill.apply(this,o(this._fillStack.shift())):(this._filling=!1,setTimeout((function(){r.canvas.style.cursor="crosshair"}),100))}},{key:"color",get:function(){return this.context.strokeStyle},set:function(t){if("string"!=typeof t)throw new Error("wrong argument type");this.context.strokeStyle=t}},{key:"weight",get:function(){return this._weight},set:function(t){if("number"!=typeof t)throw new Error("wrong argument type");this._weight=t,this._thickness=t,this._targetThickness=t,this._maxWeight=t+this.WEIGHT_SPREAD}},{key:"adaptiveStroke",get:function(){return this._adaptive},set:function(t){this._adaptive=!!t}},{key:"mode",get:function(){return this._mode},set:function(t){if("string"!=typeof t)throw new Error("wrong argument type");switch(t){case"erase":this._mode="erase",this.context.globalCompositeOperation="destination-out";break;case"fill":this._mode="fill",this.context.globalCompositeOperation="source-over";break;default:this._mode="draw",this.context.globalCompositeOperation="source-over"}}},{key:"dirty",get:function(){return!!this._dirty}},{key:"smoothing",get:function(){return this._smoothing===this.SMOOTHING_INIT},set:function(t){if("boolean"!=typeof t)throw new Error("wrong argument type");this._smoothing=t?this.SMOOTHING_INIT:0}},{key:"opacity",set:function(t){if("number"!=typeof t)throw new Error("wrong argument type");this.context.globalAlpha=t>=1?1:t/10}}])&&i(e.prototype,n),s&&i(e,s),t}()},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var c=function(t){function e(){var t;return s(this,e),(t=o(this,i(e).call(this,0,0))).down=!1,t.px=0,t.py=0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(e,t),e}(function(){function t(e,n){s(this,t),this.x=e,this.y=n}var e,n,o;return e=t,(n=[{key:"set",value:function(t,e){this.x=t,this.y=e}}])&&a(e.prototype,n),o&&a(e,o),t}());t.exports=c}]);
//# sourceMappingURL=atrament.min.js.map